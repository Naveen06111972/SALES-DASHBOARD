<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sales Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --bg: #0f0f13; --surface: #16161d; --surface2: #1c1c26; --border: #252530;
  --gold: #d4a843; --gold2: #f0c96a; --teal: #2dd4bf; --rose: #fb7185;
  --blue: #60a5fa; --purple: #a78bfa; --text: #e8e8f0; --text2: #8888a0; --text3: #55556a;
}
body { background: var(--bg); color: var(--text); font-family: 'DM Sans', sans-serif; font-size: 14px; min-height: 100vh; }
body::before {
  content: ''; position: fixed; inset: 0; pointer-events: none; z-index: 0;
  background: radial-gradient(ellipse at 0% 0%, rgba(212,168,67,0.07) 0%, transparent 40%),
              radial-gradient(ellipse at 100% 100%, rgba(45,212,191,0.05) 0%, transparent 40%);
}

/* HEADER */
header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 18px 28px; border-bottom: 1px solid var(--border);
  background: rgba(15,15,19,0.97); backdrop-filter: blur(10px);
  position: sticky; top: 0; z-index: 200;
}
.brand { display: flex; align-items: center; gap: 12px; }
.brand-icon { width: 34px; height: 34px; background: linear-gradient(135deg, var(--gold), var(--gold2)); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 15px; }
.brand-name { font-family: 'DM Serif Display', serif; font-size: 19px; letter-spacing: -0.3px; }
.brand-sub { font-size: 10px; color: var(--text3); letter-spacing: 2px; text-transform: uppercase; margin-top: 1px; }
.header-right { display: flex; align-items: center; gap: 12px; }
.period-tabs { display: flex; background: var(--surface); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
.period-tab { padding: 6px 13px; font-size: 12px; font-weight: 500; color: var(--text2); cursor: pointer; border: none; background: transparent; font-family: 'DM Sans', sans-serif; transition: all 0.2s; }
.period-tab.active { background: var(--gold); color: #0f0f13; font-weight: 600; }
.live-badge { display: flex; align-items: center; gap: 6px; font-size: 11px; color: var(--teal); font-weight: 500; }
.live-dot { width: 7px; height: 7px; background: var(--teal); border-radius: 50%; animation: pulse 2s infinite; }
@keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.5;transform:scale(0.8)} }

/* ADD DATA BUTTON */
.add-btn {
  display: flex; align-items: center; gap: 7px;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  color: #0f0f13; font-family: 'DM Sans', sans-serif; font-size: 12px;
  font-weight: 700; padding: 8px 16px; border-radius: 10px;
  border: none; cursor: pointer; transition: all 0.2s; letter-spacing: 0.3px;
}
.add-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 20px rgba(212,168,67,0.3); }

/* DRAWER OVERLAY */
.overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 300;
  opacity: 0; pointer-events: none; transition: opacity 0.3s;
}
.overlay.open { opacity: 1; pointer-events: all; }

/* DRAWER */
.drawer {
  position: fixed; top: 0; right: -500px; width: 460px; height: 100vh;
  background: var(--surface); border-left: 1px solid var(--border);
  z-index: 400; transition: right 0.35s cubic-bezier(0.4,0,0.2,1);
  display: flex; flex-direction: column; overflow: hidden;
}
.drawer.open { right: 0; }
.drawer-header {
  padding: 22px 24px 18px; border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between; flex-shrink: 0;
}
.drawer-title { font-family: 'DM Serif Display', serif; font-size: 20px; }
.drawer-sub { font-size: 11px; color: var(--text3); margin-top: 2px; }
.close-btn { background: var(--surface2); border: 1px solid var(--border); border-radius: 8px; color: var(--text2); font-size: 18px; width: 34px; height: 34px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
.close-btn:hover { border-color: var(--rose); color: var(--rose); }

/* DRAWER TABS */
.drawer-tabs { display: flex; border-bottom: 1px solid var(--border); flex-shrink: 0; }
.dtab { flex: 1; padding: 12px; text-align: center; font-size: 11px; font-weight: 600; letter-spacing: 1px; text-transform: uppercase; color: var(--text3); cursor: pointer; border: none; background: transparent; font-family: 'DM Sans', sans-serif; transition: all 0.2s; border-bottom: 2px solid transparent; }
.dtab.active { color: var(--gold); border-bottom-color: var(--gold); }

/* DRAWER BODY */
.drawer-body { flex: 1; overflow-y: auto; padding: 20px 24px; }
.drawer-body::-webkit-scrollbar { width: 4px; }
.drawer-body::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

/* FORM STYLES */
.form-section { margin-bottom: 24px; }
.form-section-title { font-size: 10px; letter-spacing: 2.5px; text-transform: uppercase; color: var(--text3); font-weight: 600; margin-bottom: 14px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
.form-row.full { grid-template-columns: 1fr; }
.form-group { display: flex; flex-direction: column; gap: 5px; }
.form-group label { font-size: 11px; color: var(--text2); font-weight: 500; }
.form-group input, .form-group select {
  background: var(--surface2); border: 1px solid var(--border); border-radius: 9px;
  color: var(--text); font-family: 'DM Sans', sans-serif; font-size: 13px;
  padding: 9px 12px; outline: none; transition: border-color 0.2s;
  width: 100%;
}
.form-group input:focus, .form-group select:focus { border-color: var(--gold); }
.form-group input::placeholder { color: var(--text3); }
.form-group select option { background: var(--surface2); }

/* REP ROWS */
.rep-row { background: var(--surface2); border: 1px solid var(--border); border-radius: 10px; padding: 12px; margin-bottom: 8px; }
.rep-row-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
.rep-row-num { font-size: 10px; color: var(--text3); font-weight: 600; letter-spacing: 1px; }
.rep-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.rep-inputs .form-group label { font-size: 10px; }
.rep-inputs .form-group input { padding: 7px 10px; font-size: 12px; }
.remove-rep {
  background: rgba(251,113,133,0.12);
  border: 1px solid rgba(251,113,133,0.3);
  color: var(--rose);
  cursor: pointer;
  font-size: 16px;
  width: 32px; height: 32px;
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s;
  flex-shrink: 0;
}
.remove-rep:hover { background: var(--rose); color: #fff; border-color: var(--rose); transform: scale(1.1); }
.add-rep-btn { width: 100%; padding: 9px; background: transparent; border: 1px dashed var(--border); border-radius: 9px; color: var(--text3); font-family: 'DM Sans', sans-serif; font-size: 12px; cursor: pointer; transition: all 0.2s; margin-top: 4px; }
.add-rep-btn:hover { border-color: var(--gold); color: var(--gold); }

/* DRAWER FOOTER */
.drawer-footer { padding: 16px 24px; border-top: 1px solid var(--border); display: flex; gap: 10px; flex-shrink: 0; }
.apply-btn { flex: 1; padding: 12px; background: linear-gradient(135deg, var(--gold), var(--gold2)); color: #0f0f13; border: none; border-radius: 10px; font-family: 'DM Sans', sans-serif; font-size: 13px; font-weight: 700; cursor: pointer; transition: all 0.2s; }
.apply-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 20px rgba(212,168,67,0.3); }
.reset-btn { padding: 12px 20px; background: transparent; border: 1px solid var(--border); border-radius: 10px; color: var(--text2); font-family: 'DM Sans', sans-serif; font-size: 13px; cursor: pointer; transition: all 0.2s; }
.reset-btn:hover { border-color: var(--rose); color: var(--rose); }

/* TOAST */
.toast { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%) translateY(80px); background: var(--teal); color: #0f0f13; font-size: 13px; font-weight: 600; padding: 12px 24px; border-radius: 30px; z-index: 999; transition: transform 0.3s; pointer-events: none; }
.toast.show { transform: translateX(-50%) translateY(0); }

/* MAIN */
main { padding: 24px 28px; max-width: 1400px; margin: 0 auto; position: relative; z-index: 1; }
.section-label { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--text3); margin-bottom: 14px; font-weight: 600; }
@keyframes slideUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }

/* KPI */
.kpi-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 14px; margin-bottom: 24px; animation: slideUp 0.5s ease both; }
.kpi-card { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; padding: 20px; position: relative; overflow: hidden; transition: border-color 0.2s, transform 0.2s; }
.kpi-card:hover { border-color: rgba(212,168,67,0.4); transform: translateY(-2px); }
.kpi-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; border-radius: 2px 2px 0 0; }
.kpi-card.gold::before { background: linear-gradient(90deg, var(--gold), var(--gold2)); }
.kpi-card.teal::before { background: var(--teal); }
.kpi-card.rose::before { background: var(--rose); }
.kpi-card.blue::before { background: var(--blue); }
.kpi-label { font-size: 10px; color: var(--text3); font-weight: 600; letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 8px; }
.kpi-value { font-family: 'DM Serif Display', serif; font-size: 32px; line-height: 1; margin-bottom: 10px; letter-spacing: -1px; }
.kpi-card.gold .kpi-value { color: var(--gold2); }
.kpi-card.teal .kpi-value { color: var(--teal); }
.kpi-card.rose .kpi-value { color: var(--rose); }
.kpi-card.blue .kpi-value { color: var(--blue); }
.kpi-change { display: inline-flex; align-items: center; gap: 4px; font-size: 11px; font-weight: 600; padding: 3px 9px; border-radius: 20px; }
.kpi-change.up { background: rgba(45,212,191,0.12); color: var(--teal); }
.kpi-change.down { background: rgba(251,113,133,0.12); color: var(--rose); }
.kpi-sub { font-size: 11px; color: var(--text3); margin-top: 6px; }

/* CHARTS */
.charts-row { display: grid; grid-template-columns: 2fr 1fr; gap: 14px; margin-bottom: 24px; animation: slideUp 0.5s 0.1s ease both; }
.chart-card { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; padding: 22px; }
.chart-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 18px; }
.chart-title { font-family: 'DM Serif Display', serif; font-size: 16px; }
.chart-subtitle { font-size: 11px; color: var(--text3); margin-top: 3px; }
.chart-legend { display: flex; gap: 12px; }
.legend-item { display: flex; align-items: center; gap: 5px; font-size: 11px; color: var(--text2); }
.legend-dot { width: 8px; height: 8px; border-radius: 50%; }

/* BOTTOM */
.bottom-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 14px; animation: slideUp 0.5s 0.2s ease both; }
.table-card { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; padding: 22px; grid-column: span 2; }
table { width: 100%; border-collapse: collapse; }
thead th { text-align: left; font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--text3); font-weight: 600; padding-bottom: 12px; border-bottom: 1px solid var(--border); }
tbody tr { border-bottom: 1px solid rgba(37,37,48,0.6); transition: background 0.15s; }
tbody tr:hover { background: rgba(255,255,255,0.02); }
tbody tr:last-child { border-bottom: none; }
td { padding: 12px 0; font-size: 13px; }
.rep-name { font-weight: 500; display: flex; align-items: center; gap: 9px; }
.avatar { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 700; flex-shrink: 0; }
.progress-bar { height: 5px; background: var(--border); border-radius: 10px; overflow: hidden; width: 70px; }
.progress-fill { height: 100%; border-radius: 10px; }
.badge { display: inline-block; padding: 3px 8px; border-radius: 20px; font-size: 10px; font-weight: 600; }
.badge.green { background: rgba(45,212,191,0.12); color: var(--teal); }
.badge.yellow { background: rgba(212,168,67,0.15); color: var(--gold2); }
.badge.red { background: rgba(251,113,133,0.12); color: var(--rose); }

/* DONUT */
.donut-card { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; padding: 22px; }
.donut-wrap { position: relative; width: 150px; height: 150px; margin: 14px auto; }
.donut-center { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; pointer-events: none; }
.donut-center-val { font-family: 'DM Serif Display', serif; font-size: 22px; color: var(--gold2); line-height: 1; }
.donut-center-label { font-size: 10px; color: var(--text3); margin-top: 3px; }
.region-list { margin-top: 14px; display: flex; flex-direction: column; gap: 9px; }
.region-item { display: flex; align-items: center; justify-content: space-between; font-size: 12px; }
.region-name { display: flex; align-items: center; gap: 7px; color: var(--text2); }
.region-dot { width: 7px; height: 7px; border-radius: 50%; }
.region-val { font-weight: 600; color: var(--text); }

@media(max-width:1100px){ .kpi-grid{grid-template-columns:repeat(2,1fr)} .charts-row{grid-template-columns:1fr} .bottom-row{grid-template-columns:1fr} .table-card{grid-column:span 1} }
@media(max-width:600px){ main{padding:16px} header{padding:14px 16px} .kpi-grid{grid-template-columns:1fr 1fr;gap:10px} .drawer{width:100vw} }
</style>
</head>
<body>

<!-- OVERLAY -->
<div class="overlay" id="overlay" onclick="closeDrawer()"></div>

<!-- DRAWER -->
<div class="drawer" id="drawer">
  <div class="drawer-header">
    <div>
      <div class="drawer-title">Add / Edit Data</div>
      <div class="drawer-sub">Update dashboard with your own numbers</div>
    </div>
    <button class="close-btn" onclick="closeDrawer()">‚úï</button>
  </div>

  <div class="drawer-tabs">
    <button class="dtab active" onclick="switchTab('kpi',this)">KPIs</button>
    <button class="dtab" onclick="switchTab('revenue',this)">Revenue</button>
    <button class="dtab" onclick="switchTab('reps',this)">Sales Reps</button>
    <button class="dtab" onclick="switchTab('regions',this)">Regions</button>
  </div>

  <div class="drawer-body">

    <!-- KPI TAB -->
    <div id="tab-kpi">
      <div class="form-section">
        <div class="form-section-title">Quarter Summary</div>
        <div class="form-row">
          <div class="form-group">
            <label>Total Revenue (e.g. $4.82M)</label>
            <input type="text" id="f-rev" placeholder="$4.82M">
          </div>
          <div class="form-group">
            <label>Revenue Change (e.g. ‚Üë 18.4%)</label>
            <input type="text" id="f-rev-ch" placeholder="‚Üë 18.4%">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Revenue Trend</label>
            <select id="f-rev-dir">
              <option value="up">‚Üë Up (Green)</option>
              <option value="down">‚Üì Down (Red)</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Deals Closed (e.g. 342)</label>
            <input type="text" id="f-deals" placeholder="342">
          </div>
          <div class="form-group">
            <label>Deals Change (e.g. ‚Üë 12.1%)</label>
            <input type="text" id="f-deals-ch" placeholder="‚Üë 12.1%">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Avg Deal Size (e.g. $14.1K)</label>
            <input type="text" id="f-avg" placeholder="$14.1K">
          </div>
          <div class="form-group">
            <label>Avg Deal Change</label>
            <input type="text" id="f-avg-ch" placeholder="‚Üë 5.7%">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Win Rate (e.g. 67%)</label>
            <input type="text" id="f-win" placeholder="67%">
          </div>
          <div class="form-group">
            <label>Win Rate Change</label>
            <input type="text" id="f-win-ch" placeholder="‚Üì 2.3%">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Win Rate Trend</label>
            <select id="f-win-dir">
              <option value="up">‚Üë Up (Green)</option>
              <option value="down">‚Üì Down (Red)</option>
            </select>
          </div>
        </div>
      </div>

      <div class="form-section">
        <div class="form-section-title">Pipeline Stages (number of deals)</div>
        <div class="form-row">
          <div class="form-group"><label>Prospecting</label><input type="number" id="p-prospect" placeholder="72"></div>
          <div class="form-group"><label>Qualified</label><input type="number" id="p-qualified" placeholder="48"></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label>Proposal</label><input type="number" id="p-proposal" placeholder="32"></div>
          <div class="form-group"><label>Negotiation</label><input type="number" id="p-negotiation" placeholder="18"></div>
        </div>
        <div class="form-row full">
          <div class="form-group"><label>Closed Won</label><input type="number" id="p-closed" placeholder="24"></div>
        </div>
      </div>
    </div>

    <!-- REVENUE TAB -->
    <div id="tab-revenue" style="display:none">
      <div class="form-section">
        <div class="form-section-title">Monthly Revenue vs Target (in $000s)</div>
        <div class="form-row">
          <div class="form-group"><label>Month 1 Name</label><input type="text" id="m1" placeholder="Oct"></div>
          <div class="form-group"><label>Month 1 Revenue ($K)</label><input type="number" id="r1" placeholder="1450"></div>
        </div>
        <div class="form-row full">
          <div class="form-group"><label>Month 1 Target ($K)</label><input type="number" id="t1" placeholder="1400"></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label>Month 2 Name</label><input type="text" id="m2" placeholder="Nov"></div>
          <div class="form-group"><label>Month 2 Revenue ($K)</label><input type="number" id="r2" placeholder="1580"></div>
        </div>
        <div class="form-row full">
          <div class="form-group"><label>Month 2 Target ($K)</label><input type="number" id="t2" placeholder="1500"></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label>Month 3 Name</label><input type="text" id="m3" placeholder="Dec"></div>
          <div class="form-group"><label>Month 3 Revenue ($K)</label><input type="number" id="r3" placeholder="1790"></div>
        </div>
        <div class="form-row full">
          <div class="form-group"><label>Month 3 Target ($K)</label><input type="number" id="t3" placeholder="1600"></div>
        </div>
      </div>
    </div>

    <!-- REPS TAB -->
    <div id="tab-reps" style="display:none">
      <div class="form-section">
        <div class="form-section-title">Sales Representatives (up to 5)</div>
        <div id="rep-rows"></div>
        <button class="add-rep-btn" onclick="addRepRow()">+ Add Representative</button>
      </div>
    </div>

    <!-- REGIONS TAB -->
    <div id="tab-regions" style="display:none">
      <div class="form-section">
        <div class="form-section-title">Revenue by Region (enter % ‚Äî must total 100)</div>
        <div class="form-row">
          <div class="form-group"><label>Region 1 Name</label><input type="text" id="reg1-name" placeholder="North America"></div>
          <div class="form-group"><label>Region 1 (%)</label><input type="number" id="reg1-val" placeholder="42"></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label>Region 2 Name</label><input type="text" id="reg2-name" placeholder="Europe"></div>
          <div class="form-group"><label>Region 2 (%)</label><input type="number" id="reg2-val" placeholder="28"></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label>Region 3 Name</label><input type="text" id="reg3-name" placeholder="Asia Pacific"></div>
          <div class="form-group"><label>Region 3 (%)</label><input type="number" id="reg3-val" placeholder="18"></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label>Region 4 Name</label><input type="text" id="reg4-name" placeholder="Rest of World"></div>
          <div class="form-group"><label>Region 4 (%)</label><input type="number" id="reg4-val" placeholder="12"></div>
        </div>
        <div style="font-size:11px;color:var(--text3);margin-top:8px;">üí° Percentages should add up to 100</div>
      </div>
    </div>

  </div><!-- drawer-body -->

  <div class="drawer-footer">
    <button class="reset-btn" onclick="resetToDefault()">Reset</button>
    <button class="apply-btn" onclick="applyData()">‚úì Apply to Dashboard</button>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast">‚úì Dashboard updated!</div>

<!-- HEADER -->
<header>
  <div class="brand">
    <div class="brand-icon">üìä</div>
    <div>
      <div class="brand-name">SalesIQ</div>
      <div class="brand-sub">Revenue Intelligence</div>
    </div>
  </div>
  <div class="header-right">
    <div class="period-tabs">
      <button class="period-tab" onclick="setPeriod('Q1',this)">Q1</button>
      <button class="period-tab" onclick="setPeriod('Q2',this)">Q2</button>
      <button class="period-tab" onclick="setPeriod('Q3',this)">Q3</button>
      <button class="period-tab active" onclick="setPeriod('Q4',this)">Q4</button>
    </div>
    <div class="live-badge"><div class="live-dot"></div>Live</div>
    <button class="add-btn" onclick="openDrawer()">‚úèÔ∏è Edit Data</button>
  </div>
</header>

<!-- MAIN DASHBOARD -->
<main>
  <div class="section-label">Key Performance Indicators</div>
  <div class="kpi-grid">
    <div class="kpi-card gold">
      <div class="kpi-label">Total Revenue</div>
      <div class="kpi-value" id="kpi-rev">$4.82M</div>
      <span class="kpi-change up" id="kpi-rev-ch">‚Üë 18.4%</span>
      <div class="kpi-sub">vs previous quarter</div>
    </div>
    <div class="kpi-card teal">
      <div class="kpi-label">Deals Closed</div>
      <div class="kpi-value" id="kpi-deals">342</div>
      <span class="kpi-change up" id="kpi-deals-ch">‚Üë 12.1%</span>
      <div class="kpi-sub">vs previous quarter</div>
    </div>
    <div class="kpi-card rose">
      <div class="kpi-label">Avg Deal Size</div>
      <div class="kpi-value" id="kpi-avg">$14.1K</div>
      <span class="kpi-change up" id="kpi-avg-ch">‚Üë 5.7%</span>
      <div class="kpi-sub">vs previous quarter</div>
    </div>
    <div class="kpi-card blue">
      <div class="kpi-label">Win Rate</div>
      <div class="kpi-value" id="kpi-win">67%</div>
      <span class="kpi-change down" id="kpi-win-ch">‚Üì 2.3%</span>
      <div class="kpi-sub">vs previous quarter</div>
    </div>
  </div>

  <div class="charts-row">
    <div class="chart-card">
      <div class="chart-header">
        <div>
          <div class="chart-title">Revenue & Target Trend</div>
          <div class="chart-subtitle">Monthly performance vs target</div>
        </div>
        <div class="chart-legend">
          <div class="legend-item"><div class="legend-dot" style="background:var(--gold)"></div>Revenue</div>
          <div class="legend-item"><div class="legend-dot" style="background:var(--text3)"></div>Target</div>
        </div>
      </div>
      <canvas id="revenueChart" height="200"></canvas>
    </div>
    <div class="chart-card">
      <div class="chart-header">
        <div>
          <div class="chart-title">Pipeline by Stage</div>
          <div class="chart-subtitle">Current quarter</div>
        </div>
      </div>
      <canvas id="pipelineChart" height="220"></canvas>
    </div>
  </div>

  <div class="section-label">Sales Team & Regional Breakdown</div>
  <div class="bottom-row">
    <div class="table-card">
      <div class="chart-header">
        <div>
          <div class="chart-title">Top Sales Representatives</div>
          <div class="chart-subtitle">Ranked by quota attainment</div>
        </div>
      </div>
      <table>
        <thead><tr><th>Representative</th><th>Revenue</th><th>Deals</th><th>Quota %</th><th>Status</th></tr></thead>
        <tbody id="repsTable"></tbody>
      </table>
    </div>
    <div class="donut-card">
      <div class="chart-title">Revenue by Region</div>
      <div class="chart-subtitle" style="color:var(--text3);font-size:11px;margin-top:3px;">Geographic distribution</div>
      <div class="donut-wrap">
        <canvas id="regionChart"></canvas>
        <div class="donut-center">
          <div class="donut-center-val" id="donut-total">$4.82M</div>
          <div class="donut-center-label">Total</div>
        </div>
      </div>
      <div class="region-list" id="regionList"></div>
    </div>
  </div>
</main>

<script>
// ‚îÄ‚îÄ DEFAULT DATA ‚îÄ‚îÄ
const defaultData = {
  Q1: {
    rev:'$3.12M',deals:'241',avg:'$12.9K',win:'61%',
    revCh:'‚Üë 8.2%',dealsCh:'‚Üë 6.4%',avgCh:'‚Üë 3.1%',winCh:'‚Üë 1.2%',
    revDir:'up',dealsDir:'up',avgDir:'up',winDir:'up',
    months:['Jan','Feb','Mar'],revenue:[820,950,1350],target:[900,900,1100],
    pipeline:[42,30,18,8,14],
    reps:[
      {name:'Priya Sharma',rev:'$520K',deals:38,quota:91},
      {name:'Rahul Mehta',rev:'$480K',deals:34,quota:85},
      {name:'Ananya Singh',rev:'$410K',deals:29,quota:74},
      {name:'Vikram Das',rev:'$350K',deals:25,quota:63},
      {name:'Neha Gupta',rev:'$290K',deals:21,quota:52},
    ],
    regionNames:['North America','Europe','Asia Pacific','Rest of World'],
    regions:[38,27,21,14],
  },
  Q2: {
    rev:'$3.64M',deals:'278',avg:'$13.1K',win:'63%',
    revCh:'‚Üë 11.5%',dealsCh:'‚Üë 9.1%',avgCh:'‚Üë 2.9%',winCh:'‚Üë 2.0%',
    revDir:'up',dealsDir:'up',avgDir:'up',winDir:'up',
    months:['Apr','May','Jun'],revenue:[1100,1200,1340],target:[1100,1150,1200],
    pipeline:[55,38,22,12,18],
    reps:[
      {name:'Priya Sharma',rev:'$620K',deals:44,quota:108},
      {name:'Vikram Das',rev:'$570K',deals:40,quota:99},
      {name:'Rahul Mehta',rev:'$500K',deals:36,quota:88},
      {name:'Neha Gupta',rev:'$420K',deals:30,quota:75},
      {name:'Ananya Singh',rev:'$340K',deals:24,quota:60},
    ],
    regionNames:['North America','Europe','Asia Pacific','Rest of World'],
    regions:[40,25,22,13],
  },
  Q3: {
    rev:'$4.10M',deals:'305',avg:'$13.4K',win:'65%',
    revCh:'‚Üë 14.2%',dealsCh:'‚Üë 9.7%',avgCh:'‚Üë 3.5%',winCh:'‚Üë 2.1%',
    revDir:'up',dealsDir:'up',avgDir:'up',winDir:'up',
    months:['Jul','Aug','Sep'],revenue:[1280,1350,1470],target:[1250,1300,1350],
    pipeline:[60,42,28,14,20],
    reps:[
      {name:'Priya Sharma',rev:'$710K',deals:50,quota:118},
      {name:'Rahul Mehta',rev:'$640K',deals:45,quota:107},
      {name:'Vikram Das',rev:'$570K',deals:40,quota:95},
      {name:'Ananya Singh',rev:'$480K',deals:34,quota:80},
      {name:'Neha Gupta',rev:'$390K',deals:28,quota:65},
    ],
    regionNames:['North America','Europe','Asia Pacific','Rest of World'],
    regions:[41,26,20,13],
  },
  Q4: {
    rev:'$4.82M',deals:'342',avg:'$14.1K',win:'67%',
    revCh:'‚Üë 18.4%',dealsCh:'‚Üë 12.1%',avgCh:'‚Üë 5.7%',winCh:'‚Üì 2.3%',
    revDir:'up',dealsDir:'up',avgDir:'up',winDir:'down',
    months:['Oct','Nov','Dec'],revenue:[1450,1580,1790],target:[1400,1500,1600],
    pipeline:[72,48,32,18,24],
    reps:[
      {name:'Priya Sharma',rev:'$840K',deals:58,quota:134},
      {name:'Rahul Mehta',rev:'$760K',deals:52,quota:121},
      {name:'Vikram Das',rev:'$650K',deals:44,quota:104},
      {name:'Ananya Singh',rev:'$520K',deals:36,quota:83},
      {name:'Neha Gupta',rev:'$420K',deals:29,quota:67},
    ],
    regionNames:['North America','Europe','Asia Pacific','Rest of World'],
    regions:[42,28,18,12],
  }
};

// Deep clone to allow editing
let periods = JSON.parse(JSON.stringify(defaultData));
let currentPeriod = 'Q4';
const regionColors = ['#d4a843','#2dd4bf','#60a5fa','#a78bfa'];
const avatarColors = ['#d4a843','#2dd4bf','#fb7185','#60a5fa','#a78bfa'];
let revenueChart, pipelineChart, regionChart;

// ‚îÄ‚îÄ CHARTS INIT ‚îÄ‚îÄ
function initCharts() {
  const d = periods[currentPeriod];
  const gc = 'rgba(255,255,255,0.04)', lc = '#55556a';
  Chart.defaults.color = lc; Chart.defaults.font.family = 'DM Sans';

  revenueChart = new Chart(document.getElementById('revenueChart'), {
    type:'bar',
    data:{ labels:d.months, datasets:[
      { label:'Revenue', data:d.revenue, backgroundColor:'rgba(212,168,67,0.25)', borderColor:'#d4a843', borderWidth:2, borderRadius:8, borderSkipped:false },
      { label:'Target', data:d.target, type:'line', borderColor:'#55556a', borderWidth:2, borderDash:[6,4], pointRadius:0, tension:0.4, fill:false }
    ]},
    options:{ responsive:true, plugins:{legend:{display:false},tooltip:{mode:'index',intersect:false}},
      scales:{ x:{grid:{color:gc},ticks:{color:lc}}, y:{grid:{color:gc},ticks:{color:lc,callback:v=>'$'+(v/1000).toFixed(0)+'K'}} } }
  });

  pipelineChart = new Chart(document.getElementById('pipelineChart'), {
    type:'bar',
    data:{ labels:['Prospecting','Qualified','Proposal','Negotiation','Closed'], datasets:[{ data:d.pipeline, backgroundColor:['#2dd4bf','#60a5fa','#a78bfa','#d4a843','#4ade80'], borderRadius:6, borderSkipped:false }] },
    options:{ indexAxis:'y', responsive:true, plugins:{legend:{display:false}},
      scales:{ x:{grid:{color:gc},ticks:{color:lc}}, y:{grid:{display:false},ticks:{color:lc}} } }
  });

  regionChart = new Chart(document.getElementById('regionChart'), {
    type:'doughnut',
    data:{ labels:d.regionNames, datasets:[{ data:d.regions, backgroundColor:regionColors, borderWidth:0, hoverOffset:6 }] },
    options:{ cutout:'72%', responsive:true, plugins:{legend:{display:false},tooltip:{callbacks:{label:ctx=>` ${ctx.label}: ${ctx.raw}%`}}} }
  });

  renderReps(d.reps); renderRegions(d.regions, d.regionNames);
}

function updateCharts() {
  const d = periods[currentPeriod];
  revenueChart.data.labels = d.months;
  revenueChart.data.datasets[0].data = d.revenue;
  revenueChart.data.datasets[1].data = d.target;
  revenueChart.update();
  pipelineChart.data.datasets[0].data = d.pipeline;
  pipelineChart.update();
  regionChart.data.labels = d.regionNames;
  regionChart.data.datasets[0].data = d.regions;
  regionChart.update();
  renderReps(d.reps); renderRegions(d.regions, d.regionNames);
  document.getElementById('donut-total').textContent = d.rev;
}

function renderReps(reps) {
  document.getElementById('repsTable').innerHTML = reps.map((r,i)=>`
    <tr>
      <td class="rep-name">
        <div class="avatar" style="background:${avatarColors[i%5]}22;color:${avatarColors[i%5]}">${r.name.split(' ').map(n=>n[0]).join('')}</div>
        ${r.name}
      </td>
      <td style="font-weight:600">${r.rev}</td>
      <td>${r.deals}</td>
      <td>
        <div style="display:flex;align-items:center;gap:8px">
          <div class="progress-bar"><div class="progress-fill" style="width:${Math.min(r.quota,100)}%;background:${r.quota>=100?'var(--teal)':r.quota>=75?'var(--gold)':'var(--rose)'}"></div></div>
          <span style="font-size:11px;color:var(--text2)">${r.quota}%</span>
        </div>
      </td>
      <td><span class="badge ${r.quota>=100?'green':r.quota>=75?'yellow':'red'}">${r.quota>=100?'Exceeded':r.quota>=75?'On Track':'At Risk'}</span></td>
    </tr>`).join('');
}

function renderRegions(data, names) {
  document.getElementById('regionList').innerHTML = names.map((n,i)=>`
    <div class="region-item">
      <div class="region-name"><div class="region-dot" style="background:${regionColors[i]}"></div>${n}</div>
      <div class="region-val">${data[i]}%</div>
    </div>`).join('');
}

function setPeriod(p, btn) {
  currentPeriod = p;
  document.querySelectorAll('.period-tab').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  const d = periods[p];
  ['rev','deals','avg','win'].forEach(k => {
    document.getElementById(`kpi-${k}`).textContent = d[k];
  });
  document.getElementById('kpi-rev-ch').textContent = d.revCh;
  document.getElementById('kpi-rev-ch').className = `kpi-change ${d.revDir}`;
  document.getElementById('kpi-deals-ch').textContent = d.dealsCh;
  document.getElementById('kpi-deals-ch').className = `kpi-change ${d.dealsDir}`;
  document.getElementById('kpi-avg-ch').textContent = d.avgCh;
  document.getElementById('kpi-avg-ch').className = `kpi-change ${d.avgDir}`;
  document.getElementById('kpi-win-ch').textContent = d.winCh;
  document.getElementById('kpi-win-ch').className = `kpi-change ${d.winDir}`;
  updateCharts();
}

// ‚îÄ‚îÄ DRAWER ‚îÄ‚îÄ
function openDrawer() {
  populateForm();
  document.getElementById('drawer').classList.add('open');
  document.getElementById('overlay').classList.add('open');
}
function closeDrawer() {
  document.getElementById('drawer').classList.remove('open');
  document.getElementById('overlay').classList.remove('open');
}

function switchTab(tab, btn) {
  ['kpi','revenue','reps','regions'].forEach(t => {
    document.getElementById(`tab-${t}`).style.display = t===tab ? 'block' : 'none';
  });
  document.querySelectorAll('.dtab').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

// ‚îÄ‚îÄ REP ROWS ‚îÄ‚îÄ
let repCount = 0;
function addRepRow(rep={}) {
  const container = document.getElementById('rep-rows');
  if(container.children.length >= 5) return;
  repCount++;
  const idx = container.children.length;
  const div = document.createElement('div');
  div.className = 'rep-row';
  div.id = `rep-row-${repCount}`;
  div.innerHTML = `
    <div class="rep-row-header">
      <span class="rep-row-num">REP ${idx+1}</span>
      <button class="remove-rep" title="Remove rep" onclick="this.closest('.rep-row').remove()">üóëÔ∏è</button>
    </div>
    <div class="rep-inputs">
      <div class="form-group" style="grid-column:span 2"><label>Full Name</label><input type="text" class="rep-name-inp" placeholder="e.g. Priya Sharma" value="${rep.name||''}"></div>
      <div class="form-group"><label>Revenue (e.g. $840K)</label><input type="text" class="rep-rev-inp" placeholder="$840K" value="${rep.rev||''}"></div>
      <div class="form-group"><label>Deals Closed</label><input type="number" class="rep-deals-inp" placeholder="58" value="${rep.deals||''}"></div>
      <div class="form-group" style="grid-column:span 2"><label>Quota Attainment (%)</label><input type="number" class="rep-quota-inp" placeholder="134" value="${rep.quota||''}"></div>
    </div>`;
  container.appendChild(div);
}

function populateForm() {
  const d = periods[currentPeriod];
  // KPI
  document.getElementById('f-rev').value = d.rev;
  document.getElementById('f-rev-ch').value = d.revCh;
  document.getElementById('f-rev-dir').value = d.revDir;
  document.getElementById('f-deals').value = d.deals;
  document.getElementById('f-deals-ch').value = d.dealsCh;
  document.getElementById('f-avg').value = d.avg;
  document.getElementById('f-avg-ch').value = d.avgCh;
  document.getElementById('f-win').value = d.win;
  document.getElementById('f-win-ch').value = d.winCh;
  document.getElementById('f-win-dir').value = d.winDir;
  // Pipeline
  const pl = ['prospect','qualified','proposal','negotiation','closed'];
  pl.forEach((k,i) => { document.getElementById(`p-${k}`).value = d.pipeline[i] || ''; });
  // Revenue months
  ['m1','m2','m3'].forEach((id,i) => { document.getElementById(id).value = d.months[i]||''; });
  ['r1','r2','r3'].forEach((id,i) => { document.getElementById(id).value = d.revenue[i]||''; });
  ['t1','t2','t3'].forEach((id,i) => { document.getElementById(id).value = d.target[i]||''; });
  // Reps
  document.getElementById('rep-rows').innerHTML = '';
  d.reps.forEach(r => addRepRow(r));
  // Regions
  d.regionNames.forEach((n,i) => {
    document.getElementById(`reg${i+1}-name`).value = n;
    document.getElementById(`reg${i+1}-val`).value = d.regions[i];
  });
}

function applyData() {
  const d = periods[currentPeriod];
  // KPI
  const rv = v(f('f-rev')), rc = v(f('f-rev-ch')), rd = v(f('f-rev-dir'));
  const dv = v(f('f-deals')), dc = v(f('f-deals-ch'));
  const av = v(f('f-avg')), ac = v(f('f-avg-ch'));
  const wv = v(f('f-win')), wc = v(f('f-win-ch')), wd = v(f('f-win-dir'));
  if(rv) d.rev = rv; if(rc) d.revCh = rc; if(rd) d.revDir = rd;
  if(dv) d.deals = dv; if(dc) d.dealsCh = dc; d.dealsDir = 'up';
  if(av) d.avg = av; if(ac) d.avgCh = ac; d.avgDir = 'up';
  if(wv) d.win = wv; if(wc) d.winCh = wc; if(wd) d.winDir = wd;

  // Pipeline
  const pl = ['prospect','qualified','proposal','negotiation','closed'];
  const newPipe = pl.map(k => parseInt(f(`p-${k}`).value)||0);
  if(newPipe.some(x=>x>0)) d.pipeline = newPipe;

  // Revenue
  const nm = [v(f('m1')),v(f('m2')),v(f('m3'))];
  const nr = [num('r1'),num('r2'),num('r3')];
  const nt = [num('t1'),num('t2'),num('t3')];
  if(nm.some(x=>x)) d.months = nm.map((x,i)=>x||d.months[i]);
  if(nr.some(x=>x)) d.revenue = nr.map((x,i)=>x||d.revenue[i]);
  if(nt.some(x=>x)) d.target = nt.map((x,i)=>x||d.target[i]);

  // Reps
  const rows = document.querySelectorAll('.rep-row');
  if(rows.length > 0) {
    d.reps = Array.from(rows).map(row => ({
      name: row.querySelector('.rep-name-inp').value || 'Rep',
      rev:  row.querySelector('.rep-rev-inp').value || '$0',
      deals: parseInt(row.querySelector('.rep-deals-inp').value)||0,
      quota: parseInt(row.querySelector('.rep-quota-inp').value)||0,
    }));
  }

  // Regions
  const rns = [1,2,3,4].map(i=>v(f(`reg${i}-name`))).filter(x=>x);
  const rvs = [1,2,3,4].map(i=>num(`reg${i}-val`)).filter(x=>x>0);
  if(rns.length>0 && rvs.length>0) { d.regionNames = rns; d.regions = rvs; }

  // Apply to display
  setPeriod(currentPeriod, document.querySelector(`.period-tab.active`));
  closeDrawer();
  showToast('Dashboard updated! üéâ');
}

function resetToDefault() {
  periods = JSON.parse(JSON.stringify(defaultData));
  setPeriod(currentPeriod, document.querySelector('.period-tab.active'));
  populateForm();
  showToast('Reset to default data');
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 2500);
}

function f(id) { return document.getElementById(id); }
function v(el) { return el ? el.value.trim() : ''; }
function num(id) { return parseFloat(document.getElementById(id).value)||0; }

initCharts();
</script>
</body>
</html>
